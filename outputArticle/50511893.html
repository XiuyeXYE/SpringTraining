<style type="text/css" >div{color:#008B8B;}</style>
<h1 style='color:green;'>        spring and hibernate mixed            </h1>
<div id="article_content" class="article_content">
<br/>
<p>runing result:<pre name="code" class="plain">16:57:17,439  INFO ClassPathXmlApplicationContext:574 - Refreshing org.springframework.context.support.ClassPathXmlApplicationContext@1de06d7e: startup date [Wed Jan 13 16:57:17 CST 2016]; root of context hierarchy<br/>
16:57:17,480  INFO XmlBeanDefinitionReader:317 - Loading XML bean definitions from class path resource [applicationContext.xml]<br/>
16:57:17,739  INFO AutowiredAnnotationBeanPostProcessor:153 - JSR-330 &#39;javax.inject.Inject&#39; annotation found and supported for autowiring<br/>
16:57:17,807  INFO MLog:92 - MLog clients using log4j logging.<br/>
16:57:17,900  INFO C3P0Registry:216 - Initializing c3p0-0.9.2.1 [built 20-March-2013 10:47:27 +0000; debug? true; trace: 10]<br/>
16:57:18,132  INFO Version:66 - HCANN000001: Hibernate Commons Annotations {4.0.5.Final}<br/>
16:57:18,136  INFO Version:54 - HHH000412: Hibernate Core {4.3.1.Final}<br/>
16:57:18,137  INFO Environment:239 - HHH000206: hibernate.properties not found<br/>
16:57:18,138  INFO Environment:346 - HHH000021: Bytecode provider name : javassist<br/>
16:57:18,172  WARN DTDEntityResolver:75 - HHH000223: Recognized obsolete hibernate namespace http://hibernate.sourceforge.net/. Use namespace http://www.hibernate.org/dtd/ instead. Refer to Hibernate 3.6 Migration Guide!<br/>
16:57:18,275  INFO AbstractPoolBackedDataSource:522 - Initializing c3p0 pool... com.mchange.v2.c3p0.ComboPooledDataSource [ acquireIncrement -&gt; 3, acquireRetryAttempts -&gt; 30, acquireRetryDelay -&gt; 1000, autoCommitOnClose -&gt; false, automaticTestTable -&gt; null, breakAfterAcquireFailure -&gt; false, checkoutTimeout -&gt; 0, connectionCustomizerClassName -&gt; null, connectionTesterClassName -&gt; com.mchange.v2.c3p0.impl.DefaultConnectionTester, dataSourceName -&gt; 1hgehpp9eg5dlw81aluvgt|75fac636, debugUnreturnedConnectionStackTraces -&gt; false, description -&gt; null, driverClass -&gt; com.mysql.jdbc.Driver, factoryClassLocation -&gt; null, forceIgnoreUnresolvedTransactions -&gt; false, identityToken -&gt; 1hgehpp9eg5dlw81aluvgt|75fac636, idleConnectionTestPeriod -&gt; 0, initialPoolSize -&gt; 3, jdbcUrl -&gt; jdbc:mysql://localhost:3306/hibernate, maxAdministrativeTaskTime -&gt; 0, maxConnectionAge -&gt; 0, maxIdleTime -&gt; 60, maxIdleTimeExcessConnections -&gt; 0, maxPoolSize -&gt; 10, maxStatements -&gt; 0, maxStatementsPerConnection -&gt; 0, minPoolSize -&gt; 1, numHelperThreads -&gt; 3, preferredTestQuery -&gt; null, properties -&gt; {user=******, password=******}, propertyCycle -&gt; 0, statementCacheNumDeferredCloseThreads -&gt; 0, testConnectionOnCheckin -&gt; false, testConnectionOnCheckout -&gt; false, unreturnedConnectionTimeout -&gt; 0, userOverrides -&gt; {}, usesTraditionalReflectiveProxies -&gt; false ]<br/>
16:57:18,456  INFO Dialect:145 - HHH000400: Using dialect: org.hibernate.dialect.MySQL5Dialect<br/>
16:57:18,462  INFO LobCreatorBuilder:123 - HHH000424: Disabling contextual LOB creation as createClob() method threw error : java.lang.reflect.InvocationTargetException<br/>
16:57:18,502  INFO TransactionFactoryInitiator:62 - HHH000399: Using default transaction strategy (direct JDBC transactions)<br/>
16:57:18,506  INFO ASTQueryTranslatorFactory:47 - HHH000397: Using ASTQueryTranslatorFactory<br/>
16:57:18,698  INFO HibernateTransactionManager:360 - Using DataSource [com.mchange.v2.c3p0.ComboPooledDataSource [ acquireIncrement -&gt; 3, acquireRetryAttempts -&gt; 30, acquireRetryDelay -&gt; 1000, autoCommitOnClose -&gt; false, automaticTestTable -&gt; null, breakAfterAcquireFailure -&gt; false, checkoutTimeout -&gt; 0, connectionCustomizerClassName -&gt; null, connectionTesterClassName -&gt; com.mchange.v2.c3p0.impl.DefaultConnectionTester, dataSourceName -&gt; 1hgehpp9eg5dlw81aluvgt|75fac636, debugUnreturnedConnectionStackTraces -&gt; false, description -&gt; null, driverClass -&gt; com.mysql.jdbc.Driver, factoryClassLocation -&gt; null, forceIgnoreUnresolvedTransactions -&gt; false, identityToken -&gt; 1hgehpp9eg5dlw81aluvgt|75fac636, idleConnectionTestPeriod -&gt; 0, initialPoolSize -&gt; 3, jdbcUrl -&gt; jdbc:mysql://localhost:3306/hibernate, maxAdministrativeTaskTime -&gt; 0, maxConnectionAge -&gt; 0, maxIdleTime -&gt; 60, maxIdleTimeExcessConnections -&gt; 0, maxPoolSize -&gt; 10, maxStatements -&gt; 0, maxStatementsPerConnection -&gt; 0, minPoolSize -&gt; 1, numHelperThreads -&gt; 3, preferredTestQuery -&gt; null, properties -&gt; {user=******, password=******}, propertyCycle -&gt; 0, statementCacheNumDeferredCloseThreads -&gt; 0, testConnectionOnCheckin -&gt; false, testConnectionOnCheckout -&gt; false, unreturnedConnectionTimeout -&gt; 0, userOverrides -&gt; {}, usesTraditionalReflectiveProxies -&gt; false ]] of Hibernate SessionFactory for HibernateTransactionManager<br/>
16:57:18,853 DEBUG SQL:109 - <br/>
    select<br/>
        user0_.id as id1_0_,<br/>
        user0_.name as name2_0_,<br/>
        user0_.password as password3_0_ <br/>
    from<br/>
        user user0_<br/>
Hibernate: <br/>
    select<br/>
        user0_.id as id1_0_,<br/>
        user0_.name as name2_0_,<br/>
        user0_.password as password3_0_ <br/>
    from<br/>
        user user0_<br/>
User [id=1, name=xiuye, password=888888888888]<br/>
</pre><pre name="code" class="html">applicationContext.xml:<br/>
&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;<br/>
&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;<br/>
	xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:tx=&quot;http://www.springframework.org/schema/tx&quot;<br/>
	xmlns:aop=&quot;http://www.springframework.org/schema/aop&quot; xmlns:context=&quot;http://www.springframework.org/schema/context&quot;<br/>
	xmlns:jee=&quot;http://www.springframework.org/schema/jee&quot;<br/>
	xsi:schemaLocation=&quot;<br/>
            http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-2.5.xsd<br/>
            http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-2.5.xsd<br/>
            http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.5.xsd<br/>
            http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-2.5.xsd<br/>
            http://www.springframework.org/schema/jee http://www.springframework.org/schema/jee/spring-jee-2.5.xsd&quot;&gt;<br/>
<br/>
	&lt;bean id=&quot;ds&quot; class=&quot;com.mchange.v2.c3p0.ComboPooledDataSource&quot;<br/>
		destroy-method=&quot;close&quot;&gt;<br/>
		&lt;property name=&quot;jdbcUrl&quot; value=&quot;jdbc:mysql://localhost:3306/hibernate&quot;&gt;&lt;/property&gt;<br/>
		&lt;property name=&quot;driverClass&quot; value=&quot;com.mysql.jdbc.Driver&quot;&gt;&lt;/property&gt;<br/>
		&lt;property name=&quot;user&quot; value=&quot;root&quot;&gt;&lt;/property&gt;<br/>
		&lt;property name=&quot;password&quot; value=&quot;123456&quot;&gt;&lt;/property&gt;<br/>
		&lt;property name=&quot;initialPoolSize&quot; value=&quot;3&quot;&gt;&lt;/property&gt;<br/>
		&lt;property name=&quot;maxPoolSize&quot; value=&quot;10&quot;&gt;&lt;/property&gt;<br/>
		&lt;property name=&quot;minPoolSize&quot; value=&quot;1&quot;&gt;&lt;/property&gt;<br/>
		&lt;property name=&quot;acquireIncrement&quot; value=&quot;3&quot;&gt;&lt;/property&gt;<br/>
<br/>
		&lt;property name=&quot;maxIdleTime&quot; value=&quot;60&quot;&gt;&lt;/property&gt;<br/>
<br/>
	&lt;/bean&gt;<br/>
	<br/>
	&lt;bean id=&quot;sessionFactory&quot; class=&quot;org.springframework.orm.hibernate4.LocalSessionFactoryBean&quot;&gt;<br/>
	<br/>
		&lt;property name=&quot;dataSource&quot; ref=&quot;ds&quot;&gt;&lt;/property&gt;<br/>
	<br/>
		&lt;property name=&quot;hibernateProperties&quot;&gt;<br/>
			&lt;props&gt;<br/>
				&lt;prop key=&quot;hibernate.dialect&quot;&gt;<br/>
					org.hibernate.dialect.MySQL5Dialect<br/>
				&lt;/prop&gt;<br/>
				&lt;prop key=&quot;hibernate.show_sql&quot;&gt;true&lt;/prop&gt;<br/>
				&lt;prop key=&quot;hibernate.format_sql&quot;&gt;true&lt;/prop&gt;<br/>
			&lt;/props&gt;<br/>
			<br/>
		&lt;/property&gt;<br/>
		&lt;property name=&quot;mappingResources&quot;&gt;<br/>
				<br/>
			&lt;list&gt;<br/>
				<br/>
				&lt;value&gt;com/xiuye/bean/cost.hbm.xml&lt;/value&gt;<br/>
				<br/>
			&lt;/list&gt;<br/>
			<br/>
		&lt;/property&gt;<br/>
	<br/>
	&lt;/bean&gt;<br/>
	&lt;context:component-scan base-package=&quot;com.xiuye&quot;&gt;&lt;/context:component-scan&gt;<br/>
<br/>
	&lt;bean id=&quot;txManager&quot; class=&quot;org.springframework.orm.hibernate4.HibernateTransactionManager&quot;<br/>
		<br/>
	<br/>
	&gt;<br/>
		&lt;property name=&quot;sessionFactory&quot; ref=&quot;sessionFactory&quot;&gt;&lt;/property&gt;<br/>
	&lt;/bean&gt;<br/>
	&lt;tx:advice id=&quot;txAdvice&quot; transaction-manager=&quot;txManager&quot;&gt;<br/>
		&lt;tx:attributes&gt;<br/>
			&lt;tx:method name=&quot;update*&quot; propagation=&quot;REQUIRED&quot;/&gt;<br/>
			&lt;tx:method name=&quot;delete*&quot; propagation=&quot;REQUIRED&quot;/&gt;<br/>
			&lt;tx:method name=&quot;add*&quot; propagation=&quot;REQUIRED&quot;/&gt;<br/>
			&lt;tx:method name=&quot;load*&quot; read-only=&quot;true&quot;/&gt;<br/>
			&lt;tx:method name=&quot;execute&quot; propagation=&quot;REQUIRED&quot;/&gt;<br/>
			<br/>
		&lt;/tx:attributes&gt;<br/>
	&lt;/tx:advice&gt;<br/>
	&lt;aop:config proxy-target-class=&quot;true&quot;&gt;<br/>
		&lt;aop:advisor advice-ref=&quot;txAdvice&quot;<br/>
			pointcut=&quot;within(com.xiuye.action.*)&quot;<br/>
		/&gt;<br/>
		<br/>
	&lt;/aop:config&gt;<br/>
<br/>
&lt;/beans&gt;</pre><pre name="code" class="html">user.hbm.xml:<br/>
&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;<br/>
&lt;!DOCTYPE hibernate-mapping PUBLIC<br/>
    &quot;-//Hibernate/Hibernate Mapping DTD 3.0//EN&quot;<br/>
    &quot;http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd&quot;&gt;<br/>
    <br/>
    &lt;hibernate-mapping&gt;<br/>
    <br/>
    	&lt;class name=&quot;com.xiuye.bean.User&quot; table=&quot;user&quot;&gt;<br/>
    		&lt;id name=&quot;id&quot; type=&quot;integer&quot; column=&quot;id&quot;&gt;<br/>
    			&lt;generator class=&quot;native&quot;&gt;&lt;/generator&gt;<br/>
    		&lt;/id&gt;<br/>
    		&lt;property name=&quot;name&quot; type=&quot;string&quot; column=&quot;name&quot;&gt;&lt;/property&gt;<br/>
    		&lt;property name=&quot;password&quot; type=&quot;string&quot; column=&quot;password&quot;&gt;&lt;/property&gt;<br/>
    		<br/>
    	&lt;/class&gt;<br/>
    	<br/>
    &lt;/hibernate-mapping&gt;</pre><br><br/>
<pre name="code" class="java">package com.xiuye.bean;<br/>
<br/>
public class User {<br/>
<br/>
	private int id;<br/>
	private String name;<br/>
	private String password;<br/>
	public int getId() {<br/>
		return id;<br/>
	}<br/>
	public void setId(int id) {<br/>
		this.id = id;<br/>
	}<br/>
	public String getName() {<br/>
		return name;<br/>
	}<br/>
	public void setName(String name) {<br/>
		this.name = name;<br/>
	}<br/>
	public String getPassword() {<br/>
		return password;<br/>
	}<br/>
	public void setPassword(String password) {<br/>
		this.password = password;<br/>
	}<br/>
	@Override<br/>
	public String toString() {<br/>
		return &quot;User [id=&quot; + id + &quot;, name=&quot; + name + &quot;, password=&quot; + password<br/>
				+ &quot;]&quot;;<br/>
	}<br/>
	<br/>
	<br/>
}<br/>
</pre><br><br/>
<pre name="code" class="java">package com.xiuye.dao;<br/>
<br/>
import java.util.List;<br/>
<br/>
import com.xiuye.bean.User;<br/>
<br/>
public interface IUserDao {<br/>
<br/>
	List&lt;User&gt; findAll();<br/>
	<br/>
	User findById(int id);<br/>
	<br/>
	void save(User user);<br/>
	<br/>
	void update(User user);<br/>
	<br/>
	void delete(int id);<br/>
	<br/>
	<br/>
}<br/>
</pre><br><br/>
<pre name="code" class="java">package com.xiuye.dao.impl;<br/>
<br/>
import java.util.List;<br/>
<br/>
import javax.annotation.Resource;<br/>
<br/>
import org.hibernate.SessionFactory;<br/>
import org.springframework.orm.hibernate4.support.HibernateDaoSupport;<br/>
import org.springframework.stereotype.Repository;<br/>
<br/>
import com.xiuye.bean.User;<br/>
import com.xiuye.dao.IUserDao;<br/>
<br/>
@Repository <br/>
public class UserDaoImpl<br/>
		extends HibernateDaoSupport<br/>
			implements IUserDao {<br/>
<br/>
	@Resource<br/>
	public void setSF(SessionFactory sf){<br/>
		super.setSessionFactory(sf);<br/>
	}<br/>
	<br/>
	@SuppressWarnings(&quot;unchecked&quot;)<br/>
	@Override<br/>
	public List&lt;User&gt; findAll() {<br/>
		<br/>
		String hql = &quot;from User&quot;;<br/>
		<br/>
		return (List&lt;User&gt;) getHibernateTemplate().find(hql);<br/>
		<br/>
		<br/>
	}<br/>
<br/>
	@Override<br/>
	public User findById(int id) {<br/>
	<br/>
		return (User)getHibernateTemplate().get(User.class, id);<br/>
		<br/>
	}<br/>
<br/>
	@Override<br/>
	public void save(User user) {<br/>
		<br/>
		getHibernateTemplate().save(user);<br/>
<br/>
	}<br/>
<br/>
	@Override<br/>
	public void update(User user) {<br/>
		<br/>
		getHibernateTemplate().update(user);<br/>
		<br/>
	}<br/>
<br/>
	@Override<br/>
	public void delete(int id) {<br/>
		<br/>
		User user = new User();<br/>
		user.setId(id);<br/>
		getHibernateTemplate().delete(user);<br/>
		<br/>
	}<br/>
<br/>
}<br/>
</pre><br><br/>
<pre name="code" class="java">package com.xiuye.test;<br/>
<br/>
import java.util.List;<br/>
<br/>
import org.junit.Test;<br/>
import org.springframework.context.ApplicationContext;<br/>
import org.springframework.context.support.ClassPathXmlApplicationContext;<br/>
<br/>
import com.xiuye.bean.User;<br/>
import com.xiuye.dao.IUserDao;<br/>
<br/>
public class TestDao {<br/>
<br/>
	private String conf = &quot;applicationContext.xml&quot;;<br/>
	<br/>
	@Test<br/>
	public void test(){<br/>
		<br/>
		<br/>
		ApplicationContext ac = new ClassPathXmlApplicationContext(conf);<br/>
		IUserDao dao = (IUserDao)ac.getBean(&quot;userDaoImpl&quot;);<br/>
		List&lt;User&gt; list = dao.findAll();<br/>
		for(User u: list){<br/>
			<br/>
			System.out.println(u);<br/>
			<br/>
		}<br/>
		<br/>
		<br/>
		<br/>
		<br/>
	}<br/>
	public static void main(String args[]){<br/>
		<br/>
		new TestDao().test();<br/>
		<br/>
	}<br/>
	<br/>
	<br/>
}<br/>
</pre><br><br/>
<img src="http://img.blog.csdn.net/20160113170434888?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""></p><br/>
<p><img src="http://img.blog.csdn.net/20160113170530298?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""><br><br/>
<br><br/>
</p><br/>
   <br/>
</div>
